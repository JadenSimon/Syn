const x: unknown = null

{
    type A = { kind: 'a', data: number }
    type B = { kind: 'b', data: string }
    type C = A | B

    const v: C = { kind: 'b', data: 'hi' }

    if (v is B) {}
}

{
    type A = string[]
    const x: unknown = ['']
    if (x is A) {}
}

{
    const x: unknown = ''
    if (x is number | string) {}
}

{
    const x: unknown = ''
    if (x is 1 | 2) {}
    x is 'a'
}

{
    const x: unknown = ''
    if (x is [number]) {}
    if (x is [number, y: string]) {}
    if (x is [x: { a: string }]) {}
    if (x is any[]) {}
    if (x is [number, ...string[]]) {}
}

{
    const x: unknown = ''
    interface X { x: string }
    interface Y { y: string }
    interface Z extends X, Y { z: string }
    if (x is Z) {}
}

{
    // Classes should emit `instanceof`
    const x: unknown = ''
    class X {}
    if (x is X) {}

    // Should emit `x instanceof X && typeof x.y === 'number'`
    interface X2 extends X {
        y: number
    }
    if (x is X2) {}
}

{
    interface A {
        x: number
        y: number
        z: number
    }
    x is A | A[]
}

{
    type X = 'aa' | 'bb' | 1.1;
    x is `foo${string}bar`
    x is `foo${X}bar`
}

{
    enum X { a, b }
    x is X
    x is X.a
}

{
    switch (const x2 = x) {
        case is { y: number }:
            throw x2.y
        case 0:
        case 1:
            x2
        case 2:
            throw x2
        case 3: break
        case 4: {}
    }
}

export function f(cb: () => { y: number } | { z: string }) {
    const x = cb()
    switch (x) {
        case is { y: number }:
            return x.y
        case is { z: string }:
            return x.z
    }
}

{
    interface Node {
        parent: Node | null
        id: number
        code: string
        name: string
        sequence: number
        created_at: Timestamp
    }
    interface Timestamp {
        time: number
        zone: number
    }
    x is Node
}

{
    type A = { kind: 'a', data: number }
    type B = { kind: 'b', data: string }
    type C = { kind: 'c' }
    type D = A | B | C
    if (x is D) {
        if (x is C) {}
    }
}

{
    type A = { a?: number };
    x is A
}